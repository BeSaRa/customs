<ng-container [formGroup]="form">
  <div class="flex flex-col align-middle justify-center gap-1 p-4">
    <app-textarea formControlName="menuURL" [label]="lang.map.menu_url">
    </app-textarea>
    @if (!readonly) {
      <app-button
        [disabled]="menuUrlControl.invalid"
        (click)="checkUrlVariables(true)">
        {{ lang.map.check_url_variables }}
      </app-button>
    }
  </div>
</ng-container>
@if (variableList.length > 0) {
  <div class="grid grid-cols-2 gap-4 items-start p-4">
    <!-- Variables Table -->
    <div class="shadow relative overflow-auto">
      <table mat-table matSort class="table-style" [dataSource]="variableList">
        <!-- Variable Name Column -->
        <ng-container matColumnDef="variable">
          <th mat-header-cell *matHeaderCellDef>
            {{ lang.map.variable_name }}
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.name }}</span>
          </td>
        </ng-container>

        <!-- Variable Value Column -->
        <ng-container matColumnDef="variableValue">
          <th mat-header-cell *matHeaderCellDef>
            {{ lang.map.variable_value }}
          </th>
          <td mat-cell *matCellDef="let row; index as rowIndex">
            <div
              cdkDropList
              id="dropList-{{ rowIndex }}"
              class="value-dropzone min-h-[50px]"
              [cdkDropListConnectedTo]="['menuList']"
              (cdkDropListDropped)="drop($event, row)">
              @for (itemValue of row.valueLookups; track itemValue) {
                <div
                  class="flex items-center justify-center transition-transform duration-300 ease-in-out animate-fade-in-slide-up">
                  <span>{{ itemValue.getNames() }}</span>
                  <app-icon-button
                    [matTooltip]="lang.map.delete"
                    (click)="removeVariableValue(row)"
                    icon="DELETE">
                  </app-icon-button>
                </div>
              }
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let element; columns: displayedColumns"></tr>
        <tr class="mat-row" *matNoDataRow>
          <td class="p-4" colspan="100">
            {{ lang.map.no_records_to_display }}
          </td>
        </tr>
      </table>
    </div>

    <!-- Available Values List -->
    <div class="container relative">
      <h1 class="h6 text-primary">{{ lang.map.available_values }}</h1>
      <div
        class="list relative"
        cdkDropList
        id="menuList"
        [cdkDropListData]="menuParamsList"
        [cdkDropListSortingDisabled]="true"
        [cdkDropListConnectedTo]="getConnectedListIds()">
        @for (item of menuParamsList; track item) {
          <div class="box" cdkDrag [cdkDragData]="item">
            {{ item.getNames() }}
          </div>
        }
      </div>
    </div>
  </div>
}
